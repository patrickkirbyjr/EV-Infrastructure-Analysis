---
title: "EV Project"
output: html_notebook
---

import libraries and dataset

```{r}

library(tidyverse)
library(dplyr)
library(janitor)
library(Hmisc)
library(ggplot2)

alt_fuel_stations <- read_csv("alt_fuel_stations (Jul 7 2025).csv")
alt_fuel_stations
```

clean columns names using janitor

```{r}
alt_fuel_stations_clean <- clean_names(alt_fuel_stations)

alt_fuel_stations_clean
```

filter to only EV stations ("ELEC")

```{r}
ev_stations <- filter(alt_fuel_stations_clean, fuel_type_code == "ELEC")

ev_stations
```

take a look at the values

```{r}
summary(ev_stations)
```

select columns for study (simple set at first)
goal: where are the stations, how many of them are there per state

```{r}
ev_stations_selected <- ev_stations |>
  select(station_name, city, state, zip, country, latitude, longitude, ev_network)

ev_stations_selected
```

look at selected columns

```{r}
summary(ev_stations_selected)

```

check for missing values

```{r}
sum(is.na(ev_stations_selected))
```

export cleaned CSV file

```{r}
write.csv(ev_stations_selected, "ev_stations_selected.csv")
```

now, just US market 

```{r}
ev_stations_us <- filter(ev_stations_selected, country == "US")
ev_stations_us
```

look at different networks (checking for Tesla and Electrify America)

```{r}
ev_networks <- ev_stations_us[ ,"ev_network"]
table(ev_networks)
```
breakdown by state

```{r}
ev_stations_by_state <- ev_stations_us |>
  group_by(state) |>
  summarise(total_stations = n()) |>
  arrange(desc(total_stations))

ev_stations_by_state
```

time to plot

```{r}

ggplot(ev_stations_by_state, aes(x = reorder(state, -total_stations), y = total_stations)) + 
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(
    title = "Top 10 States by Total EV Stations",
    x = "State",
    y = "EV Stations"
  ) + 
  geom_text(aes(label = total_stations), vjust = -0.2)
```

export cleaned CSV file with only US stations

```{r}
write.csv(ev_stations_us, "ev_stations_us.csv")
```

visualize US charging stations

```{r}
library(maps)

ggplot(ev_stations_us, aes(x = longitude, y = latitude)) +
  borders("state") +
  geom_point(alpha = 0.2, color = "green", size = 0.3) +
  coord_fixed(1.3) + 
  labs(title = "US EV Charging Stations")
```
import data on number of vehicle registrations by state

```{r}
ev_registrations <- read_csv("ev_registration_by_state.csv")
ev_registrations <- clean_names(ev_registrations)
ev_registrations

```

drop total and DC rows

```{r}
ev_registrations_50 <- ev_registrations[!(ev_registrations$state) %in% c("District of Columbia", "Total"),]
ev_registrations_50
```


change state names to abbreviations

```{r}
ev_registrations_50$state <- state.abb[match(ev_registrations_50$state, state.name)]
ev_registrations_50
```

compare total number of ev stations to number of registrations by joining on state
drop PR and DC

```{r}
ev_combined <- ev_stations_by_state |>
  left_join(ev_registrations_50)

ev_combined <- ev_combined[!(ev_combined$state) %in% c("PR", "DC"),]

ev_combined
```

sort

```{r}

```













